<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Motion Tracking</title>

    <!--Meta Information about the website-->
    <meta name="author" content="crypticsy" />
    <meta name="keywords" content="crypticsy" />
    <meta name="keywords" content="github" />
    <meta name="keywords" content="sanctuary" />

    <link rel="icon" href="../assets/images/icon.ico" />
    <meta property="og:image" content="../assets/images/icon.png" />
    <meta
      property="og:url"
      content="https://crypticsy.github.io/sanctuary.github.io/"
    />

    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="HandheldFriendly" content="true" />

    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/css">
        @font-face {
            font-family: comfortaa_l;
            src: url(../assets/font/comfortaa_light.ttf);
        }
        @font-face {
            font-family: comfortaa_b;
            src: url(../assets/font/comfortaa_bold.ttf);
        }
        @font-face {
            font-family: retro_text;
            src: url(../assets/font/retro_computer.ttf);
        }

        /* Fix for mobile viewport height (accounting for browser UI) */
        :root {
            --vh: 1vh;
        }

        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 0.7rem;
            z-index: 10;
            background: rgba(0, 0, 0, 0.7);
            padding: 0.5rem;
            border-radius: 0.25rem;
            color: white;
            font-family: comfortaa_l;
        }
        #videoInput {
            display: none;
        }
        #videoControls {
            display: none;
            margin-top: 1.5rem;
        }
        #videoControls.visible {
            display: block;
        }
        #timeline {
            flex: 1;
            height: 0.5rem;
            background: #4f4f4f;
            border-radius: 0.25rem;
            cursor: pointer;
            position: relative;
        }
        #timeline:hover {
            background: #6f6f6f;
        }
        #progress {
            height: 100%;
            background: #03dc03;
            border-radius: 0.25rem;
            width: 0%;
            transition: width 0.1s linear;
        }
        #volumeSlider {
            accent-color: #03dc03;
        }
    </style>
    <script>
        // Calculate and set actual viewport height for mobile browsers
        function setVH() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        setVH();
        window.addEventListener('resize', setVH);
        window.addEventListener('orientationchange', setVH);
    </script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'comfortaa-light': ['comfortaa_l', 'sans-serif'],
                        'comfortaa-bold': ['comfortaa_b', 'sans-serif'],
                        'retro': ['retro_text', 'monospace'],
                    }
                }
            }
        }
    </script>

    <!--importing external javascript-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script src="https://unpkg.com/ml5@0.12.2/dist/ml5.min.js"></script>
    <script
      language="javascript"
      type="text/javascript"
      src="motion_tracking.js"
    ></script>
  </head>

  <body class="m-0 bg-[#212121] flex flex-col md:flex-row overflow-hidden text-[#a7a7a7] font-retro text-sm select-none">
    <div class="w-full md:w-1/2 h-auto md:max-h-screen md:h-screen p-6 sm:p-8 md:p-10 overflow-y-auto" style="max-height: calc(var(--vh, 1vh) * 50);">
      <style>@media (min-width: 768px) { .md\:max-h-screen { max-height: 100vh !important; } }</style>
      <a href="../index.html" class="inline-block px-4 sm:px-5 py-2.5 mb-6 sm:mb-8 bg-[#2a2a2a] text-[#03dc03] no-underline font-comfortaa-bold text-xs sm:text-sm rounded transition-all duration-300 hover:bg-[#03dc03] hover:text-[#212121]">
        ‚Üê Back to Home
      </a>

      <div class="pb-6 sm:pb-8">
        <h1 class="font-comfortaa-bold text-lg sm:text-xl md:text-2xl leading-tight text-white mb-5 sm:mb-6">Motion Tracking</h1>

        <p class="text-[#a7a7a7] text-justify font-comfortaa-light text-[0.7rem] sm:text-xs md:text-sm mb-5 leading-loose">
          Real-time human pose detection using PoseNet and ml5.js. Track body
          movements through your camera or upload a video to analyze motion
          patterns. The visualization creates dynamic nodes around detected
          keypoints that respond to movement.
          <a href="https://ml5js.org/" target="_blank" class="text-xs text-[#acf0ed] no-underline hover:underline">
            [ml5.js PoseNet]</a>
        </p>

        <p class="text-[#a7a7a7] text-justify font-comfortaa-light text-[0.7rem] sm:text-xs md:text-sm mb-8 leading-loose">
          Choose between live camera tracking or upload a video file to analyze.
          The system detects 17 keypoints on the body and creates an artistic
          visualization with orbiting nodes.
        </p>

        <label class="font-comfortaa-bold text-white text-xs sm:text-sm block mb-3">Mode Selection:</label>

        <div class="flex flex-wrap gap-3 mb-6">
          <button id="cameraBtn" class="rounded px-4 sm:px-5 py-2 sm:py-2.5 border-0 bg-[#03dc03] text-black text-xs sm:text-sm font-medium hover:bg-[#159b15] hover:text-white transition-colors focus:outline-none">
            Camera
          </button>
          <button id="uploadBtn" class="rounded px-4 sm:px-5 py-2 sm:py-2.5 border-0 bg-[#03dc03] text-black text-xs sm:text-sm font-medium hover:bg-[#159b15] hover:text-white transition-colors focus:outline-none">
            Upload Video
          </button>
          <button id="switchCameraBtn" class="rounded px-4 sm:px-5 py-2 sm:py-2.5 border-0 bg-[#2a2a2a] text-[#03dc03] text-xs sm:text-sm font-medium hover:bg-[#3a3a3a] transition-colors focus:outline-none hidden">
            üîÑ Switch Camera
          </button>
        </div>
        <input type="file" id="videoInput" accept="video/*" />

        <!-- Video Timeline Controls (only visible for uploaded videos) -->
        <div id="videoControls">
          <label class="font-comfortaa-bold text-white text-xs sm:text-sm block mb-3 mt-6">Video Playback:</label>
          <div class="flex items-center gap-3 mb-3">
            <span class="text-xs sm:text-sm text-[#a7a7a7] font-comfortaa-light min-w-[80px]" id="timeDisplay">0:00 / 0:00</span>
            <div id="timeline">
              <div id="progress"></div>
            </div>
          </div>

          <div class="flex flex-wrap items-center gap-3 sm:gap-4">
            <button id="playPauseBtn" class="rounded px-4 sm:px-5 py-2 sm:py-2.5 border-0 bg-[#03dc03] text-black text-xs sm:text-sm font-medium hover:bg-[#159b15] hover:text-white transition-colors focus:outline-none">
              Pause
            </button>
            <label for="volumeSlider" class="text-xs sm:text-sm font-comfortaa-light m-0">Volume:</label>
            <input
              type="range"
              id="volumeSlider"
              min="0"
              max="100"
              value="100"
              class="w-24 sm:w-32 h-2 bg-[#4f4f4f] rounded-lg appearance-none cursor-pointer"
            />
            <span id="volumeLabel" class="text-xs sm:text-sm min-w-[40px] text-right">100%</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Canvas container for p5.js -->
    <div id="canvas-container" class="w-full md:w-1/2 md:h-screen overflow-auto flex items-center justify-center relative" style="min-height: calc(var(--vh, 1vh) * 50);">
      <div id="info">Loading PoseNet model...</div>
    </div>

  </body>
</html>
